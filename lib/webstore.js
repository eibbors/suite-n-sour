// Generated by CoffeeScript 1.3.3
(function() {
  var NsWebStore, NsWebStoreClient, NsWebStoreItem, NsWebStoreSession, rpc,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  rpc = require('./rpc');

  NsWebStoreClient = (function(_super) {

    __extends(NsWebStoreClient, _super);

    function NsWebStoreClient(options) {
      NsWebStoreClient.__super__.constructor.call(this, options);
      this.session = new NsWebStoreSession(options);
    }

    NsWebStoreClient.prototype.shopr = function(path, options, cb) {
      var k, query, v, _ref, _ref1, _ref10, _ref11, _ref12, _ref13, _ref14, _ref15, _ref16, _ref17, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9;
      query = {
        c: (_ref = (_ref1 = (_ref2 = options.company) != null ? _ref2 : options.c) != null ? _ref1 : this.session.companyId) != null ? _ref : null,
        n: (_ref3 = (_ref4 = (_ref5 = options.siteNum) != null ? _ref5 : options.n) != null ? _ref4 : this.session.siteNum) != null ? _ref3 : 1,
        sc: (_ref6 = (_ref7 = (_ref8 = options.section) != null ? _ref8 : options.sc) != null ? _ref7 : this.session.section) != null ? _ref6 : null,
        category: (_ref9 = (_ref10 = options.category) != null ? _ref10 : this.session.category) != null ? _ref9 : null,
        id: (_ref11 = (_ref12 = (_ref13 = options.itemId) != null ? _ref13 : options.id) != null ? _ref12 : (_ref14 = this.session.item) != null ? _ref14.id : void 0) != null ? _ref11 : null,
        it: (_ref15 = (_ref16 = options.itemType) != null ? _ref16 : (_ref17 = this.session.item) != null ? _ref17.it : void 0) != null ? _ref15 : null
      };
      for (k in query) {
        v = query[k];
        if (v === null) {
          delete query[k];
        }
      }
      return this.get(path != null ? path : '/s.nl/.f', {
        query: query
      }, cb);
    };

    NsWebStoreClient.prototype.setWebStore = function(company, siteNum, section, category) {
      this.session.companyId = company != null ? company : null;
      this.session.siteNum = siteNum != null ? siteNum : null;
      this.session.section = section != null ? section : null;
      return this.session.category = category != null ? category : null;
    };

    NsWebStoreClient.prototype.getItemName = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemname.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getItemPrice = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemprice.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getItemWeight = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemweight.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getShortItemDescription = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemsdescr.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getLongItemDescription = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemldescr.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getFeaturedItemDescription = function(itemId, cb) {
      return this.shopr('/app/site/query/getitemfdescr.nl', {
        itemId: itemId
      }, cb);
    };

    NsWebStoreClient.prototype.getCurrentSubtotal = function(cb) {
      return this.shopr('/app/site/query/getcarttotal.nl', {}, cb);
    };

    NsWebStoreClient.prototype.getNumberOfCartItems = function(cb) {
      return this.shopr('/app/site/query/getcartitemcount.nl', {}, cb);
    };

    NsWebStoreClient.prototype.pingTracker = function(type, referer, options, cb) {
      var query, _ref, _ref1, _ref10, _ref11, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9;
      if (type == null) {
        type = 'store';
      }
      query = {
        type: type,
        c: (_ref = (_ref1 = (_ref2 = options.company) != null ? _ref2 : options.c) != null ? _ref1 : this.session.companyId) != null ? _ref : null,
        n: (_ref3 = (_ref4 = (_ref5 = options.siteNum) != null ? _ref5 : options.n) != null ? _ref4 : this.session.siteNum) != null ? _ref3 : null,
        referer: referer != null ? referer : ''
      };
      if (type === 'store') {
        query.sc = (_ref6 = options.section) != null ? _ref6 : 1;
        query.category = (_ref7 = options.category) != null ? _ref7 : '';
        query.it = (_ref8 = options.it) != null ? _ref8 : '';
        query.itemid = (_ref9 = options.itemid) != null ? _ref9 : '';
      }
      if (type === 'page') {
        query.url = (_ref10 = options.url) != null ? _ref10 : null;
        query.siteroot = (_ref11 = options.siteroot) != null ? _ref11 : null;
      }
      return this.get('/app/site/hit/tracker.nl?', {
        query: query
      }, cb);
    };

    NsWebStoreClient.prototype.addItemToCart = function(id, qty, options, cb) {
      var k, params, v;
      params = {
        ext: 'T',
        buyid: id,
        add: qty != null ? qty : 1
      };
      for (k in options) {
        v = options[k];
        params[k] = v;
      }
      return this.shopr('/app/site/query/additemtocart.nl', params, cb);
    };

    NsWebStoreClient.prototype.addGiftCertToCart = function(id, from, toName, toEmail, message, amount, qty, cb) {
      var params;
      if (qty == null) {
        qty = 1;
      }
      params = {
        GIFTCERTFROM: from,
        GIFTCERTRECIPIENTNAME: toName,
        GIFTCERTRECIPIENTEMAIL: toEmail
      };
      if (amount != null) {
        params.amount = amount;
      }
      return this.addItemToCart(id, qty, params, cb);
    };

    return NsWebStoreClient;

  })(rpc.Client);

  NsWebStoreSession = (function() {

    function NsWebStoreSession(options) {
      var _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6;
      this.host = (_ref = options.host) != null ? _ref : 'shopping.netsuite.com';
      this.customDomain = (_ref1 = options.domain) != null ? _ref1 : null;
      this.customPath = (_ref2 = options.path) != null ? _ref2 : null;
      this.companyId = (_ref3 = options.company) != null ? _ref3 : null;
      this.siteNum = (_ref4 = options.siteNum) != null ? _ref4 : 1;
      this.visitorId = (_ref5 = options.visitorId) != null ? _ref5 : null;
      this.shopperId = (_ref6 = options.shopperId) != null ? _ref6 : null;
    }

    return NsWebStoreSession;

  })();

  NsWebStore = (function() {

    function NsWebStore(options) {
      var _ref, _ref1, _ref10, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _ref8, _ref9;
      this.company = (_ref = (_ref1 = options.company) != null ? _ref1 : options.c) != null ? _ref : null;
      this.siteNum = (_ref2 = (_ref3 = options.siteNum) != null ? _ref3 : options.n) != null ? _ref2 : null;
      this.domains = {
        shopping: (_ref4 = options.customDomain) != null ? _ref4 : 'shopping.netsuite.com',
        checkout: (_ref5 = options.customDomain) != null ? _ref5 : 'checkout.netsuite.com'
      };
      this.sections = (_ref6 = options.sections) != null ? _ref6 : {};
      this.categories = (_ref7 = options.categories) != null ? _ref7 : {};
      this.items = (_ref8 = options.items) != null ? _ref8 : {};
      this.section = (_ref9 = (_ref10 = options.sections) != null ? _ref10 : options.sc) != null ? _ref9 : null;
    }

    return NsWebStore;

  })();

  NsWebStoreItem = (function() {

    function NsWebStoreItem(id, type, options) {
      var _ref, _ref1, _ref2, _ref3, _ref4, _ref5;
      this.id = id;
      this.type = type != null ? type : 'A';
      this.name = (_ref = options.name) != null ? _ref : null;
      this.price = (_ref1 = options.price) != null ? _ref1 : null;
      this.weight = (_ref2 = options.weight) != null ? _ref2 : null;
      this.sDescr = (_ref3 = options.sDescr) != null ? _ref3 : null;
      this.lDescr = (_ref4 = options.lDescr) != null ? _ref4 : null;
      this.fDescr = (_ref5 = options.fDescr) != null ? _ref5 : null;
    }

    return NsWebStoreItem;

  })();

  module.exports = {
    Client: NsWebStoreClient,
    Session: NsWebStoreSession
  };

}).call(this);
